# 快速开始指南

## 第一步：安装依赖

打开命令行，进入项目目录，运行：

```bash
pip install Flask flask-cors
```

或者使用 requirements.txt：

```bash
pip install -r requirements.txt
```

## 第二步：启动服务器

### 方法1：双击启动（Windows）
直接双击 `start_server.bat` 文件

### 方法2：命令行启动
```bash
python app.py
```

看到以下信息说明启动成功：
```
图片服务器启动中...
服务器地址: http://localhost:5000
头像上传接口: http://localhost:5000/api/upload/avatar
动态图片上传接口: http://localhost:5000/api/upload/feed
批量上传接口: http://localhost:5000/api/upload/feed/batch
 * Running on http://0.0.0.0:5000
```

## 第三步：测试服务器

使用测试脚本测试上传功能：

```bash
python test_upload.py test.jpg
```

或者在浏览器访问：
```
http://localhost:5000/api/health
```

看到以下响应说明服务器正常：
```json
{
  "success": true,
  "status": "running",
  "msg": "服务器运行正常"
}
```

## 第四步：配置小程序

### 1. 开启不校验域名

在微信开发者工具中：
1. 右上角 详情
2. 本地设置
3. 勾选 "不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"

### 2. 修改服务器地址（如需要）

如果服务器部署在其他地址，修改小程序中的服务器地址：

打开 `miniprogram/pages/publish/publish.ts`

```typescript
const SERVER_URL = 'http://localhost:5000' // 改为你的服务器地址
```

## 第五步：开始使用

1. 在小程序中进入"探索"页面
2. 点击右上角的发布按钮
3. 选择图片并发布
4. 图片会自动上传到你的服务器
5. 其他用户也能看到图片了！

## 常见问题

### Q: 小程序上传失败？
A:
1. 确认服务器已启动
2. 确认已开启"不校验合法域名"
3. 检查服务器地址是否正确（注意 localhost vs 127.0.0.1 vs IP地址）

### Q: 如何部署到云服务器？
A:
1. 修改 `app.py` 中的 `SERVER_HOST` 为服务器IP或域名
2. 在服务器上运行 `python app.py`
3. 开放防火墙端口（默认5000）
4. 修改小程序中的 `SERVER_URL` 为服务器地址

### Q: 如何查看上传的图片？
A:
图片保存在项目的 `uploads` 文件夹中：
- `uploads/avatars/` - 用户头像
- `uploads/feeds/` - 动态图片

### Q: 端口被占用怎么办？
A:
修改 `app.py` 中的 `SERVER_PORT = 5000` 为其他端口，例如 `5001`

## 技术支持

如果遇到问题，请查看：
1. 服务器控制台输出
2. 小程序开发者工具的控制台
3. README.md 文档的详细说明
